<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ndn-lite: ndn-lite/security/detail/default-backend/sec-lib/tinycrypt/tc_hmac.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ndn-lite
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_7b0e37da7babb979670076952144507a.html">ndn-lite</a></li><li class="navelem"><a class="el" href="dir_e11f8668a8afaa48b9db85612cf98717.html">security</a></li><li class="navelem"><a class="el" href="dir_4ffa99c4c6c62fc7e750c61d6d7ea688.html">detail</a></li><li class="navelem"><a class="el" href="dir_49fd263b56478561f7cdd77b538569d5.html">default-backend</a></li><li class="navelem"><a class="el" href="dir_27af200cdbae7975d997499e67e9e2cc.html">sec-lib</a></li><li class="navelem"><a class="el" href="dir_d2e430651bddbae665f4977d269e437d.html">tinycrypt</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tc_hmac.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Interface to an HMAC implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="tc__sha256_8h_source.html">tc_sha256.h</a>&quot;</code><br />
</div>
<p><a href="tc__hmac_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtc__hmac__state__struct.html">tc_hmac_state_struct</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a73d9f54416f1838f8a52e84e57d0393c"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structtc__hmac__state__struct.html">tc_hmac_state_struct</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tc__hmac_8h.html#a73d9f54416f1838f8a52e84e57d0393c">TCHmacState_t</a></td></tr>
<tr class="separator:a73d9f54416f1838f8a52e84e57d0393c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af372d6392e15439a96bc528282c5f819"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tc__hmac_8h.html#af372d6392e15439a96bc528282c5f819">tc_hmac_set_key</a> (<a class="el" href="tc__hmac_8h.html#a73d9f54416f1838f8a52e84e57d0393c">TCHmacState_t</a> ctx, const uint8_t *key, unsigned int key_size)</td></tr>
<tr class="memdesc:af372d6392e15439a96bc528282c5f819"><td class="mdescLeft">&#160;</td><td class="mdescRight">HMAC set key procedure Configures ctx to use key.  <a href="#af372d6392e15439a96bc528282c5f819">More...</a><br /></td></tr>
<tr class="separator:af372d6392e15439a96bc528282c5f819"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09fe4e1360cf5217ce1e6715645b6d23"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tc__hmac_8h.html#a09fe4e1360cf5217ce1e6715645b6d23">tc_hmac_init</a> (<a class="el" href="tc__hmac_8h.html#a73d9f54416f1838f8a52e84e57d0393c">TCHmacState_t</a> ctx)</td></tr>
<tr class="memdesc:a09fe4e1360cf5217ce1e6715645b6d23"><td class="mdescLeft">&#160;</td><td class="mdescRight">HMAC init procedure Initializes ctx to begin the next HMAC operation.  <a href="#a09fe4e1360cf5217ce1e6715645b6d23">More...</a><br /></td></tr>
<tr class="separator:a09fe4e1360cf5217ce1e6715645b6d23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83321bef5a518417fb895bab06322e05"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tc__hmac_8h.html#a83321bef5a518417fb895bab06322e05">tc_hmac_update</a> (<a class="el" href="tc__hmac_8h.html#a73d9f54416f1838f8a52e84e57d0393c">TCHmacState_t</a> ctx, const void *data, unsigned int data_length)</td></tr>
<tr class="memdesc:a83321bef5a518417fb895bab06322e05"><td class="mdescLeft">&#160;</td><td class="mdescRight">HMAC update procedure Mixes data_length bytes addressed by data into state.  <a href="#a83321bef5a518417fb895bab06322e05">More...</a><br /></td></tr>
<tr class="separator:a83321bef5a518417fb895bab06322e05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4340c093d57accd09bf85b645b4670b1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tc__hmac_8h.html#a4340c093d57accd09bf85b645b4670b1">tc_hmac_final</a> (uint8_t *tag, unsigned int taglen, <a class="el" href="tc__hmac_8h.html#a73d9f54416f1838f8a52e84e57d0393c">TCHmacState_t</a> ctx)</td></tr>
<tr class="memdesc:a4340c093d57accd09bf85b645b4670b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">HMAC final procedure Writes the HMAC tag into the tag buffer.  <a href="#a4340c093d57accd09bf85b645b4670b1">More...</a><br /></td></tr>
<tr class="separator:a4340c093d57accd09bf85b645b4670b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Interface to an HMAC implementation. </p>
<p>Overview: HMAC is a message authentication code based on hash functions. TinyCrypt hard codes SHA-256 as the hash function. A message authentication code based on hash functions is also called a keyed cryptographic hash function since it performs a transformation specified by a key in an arbitrary length data set into a fixed length data set (also called tag).</p>
<p>Security: The security of the HMAC depends on the length of the key and on the security of the hash function. Note that HMAC primitives are much less affected by collision attacks than their corresponding hash functions.</p>
<p>Requires: SHA-256</p>
<p>Usage: 1) call tc_hmac_set_key to set the HMAC key. </p><pre class="fragment">        2) call tc_hmac_init to initialize a struct hash_state before
        processing the data.

        3) call tc_hmac_update to process the next input segment;
        tc_hmac_update can be called as many times as needed to process
        all of the segments of the input; the order is important.

        4) call tc_hmac_final to out put the tag.
</pre> </div><h2 class="groupheader">Typedef Documentation</h2>
<a id="a73d9f54416f1838f8a52e84e57d0393c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73d9f54416f1838f8a52e84e57d0393c">&#9670;&nbsp;</a></span>TCHmacState_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structtc__hmac__state__struct.html">tc_hmac_state_struct</a>* <a class="el" href="tc__hmac_8h.html#a73d9f54416f1838f8a52e84e57d0393c">TCHmacState_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a4340c093d57accd09bf85b645b4670b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4340c093d57accd09bf85b645b4670b1">&#9670;&nbsp;</a></span>tc_hmac_final()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tc_hmac_final </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>taglen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tc__hmac_8h.html#a73d9f54416f1838f8a52e84e57d0393c">TCHmacState_t</a>&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>HMAC final procedure Writes the HMAC tag into the tag buffer. </p>
<dl class="section return"><dt>Returns</dt><dd>returns TC_CRYPTO_SUCCESS (1) returns TC_CRYPTO_FAIL (0) if: tag == NULL or ctx == NULL or key == NULL or taglen != TC_SHA256_DIGEST_SIZE </dd></dl>
<dl class="section note"><dt>Note</dt><dd>ctx is erased before exiting. This should never be changed/removed. </dd>
<dd>
Assumes the tag bufer is at least sizeof(hmac_tag_size(state)) bytes state has been initialized by tc_hmac_init </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tag</td><td>IN/OUT &ndash; buffer to receive computed HMAC tag </td></tr>
    <tr><td class="paramname">taglen</td><td>IN &ndash; size of tag in bytes </td></tr>
    <tr><td class="paramname">ctx</td><td>IN/OUT &ndash; the HMAC state for computing tag </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a09fe4e1360cf5217ce1e6715645b6d23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09fe4e1360cf5217ce1e6715645b6d23">&#9670;&nbsp;</a></span>tc_hmac_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tc_hmac_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tc__hmac_8h.html#a73d9f54416f1838f8a52e84e57d0393c">TCHmacState_t</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>HMAC init procedure Initializes ctx to begin the next HMAC operation. </p>
<dl class="section return"><dt>Returns</dt><dd>returns TC_CRYPTO_SUCCESS (1) returns TC_CRYPTO_FAIL (0) if: ctx == NULL or key == NULL </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>IN/OUT &ndash; struct <a class="el" href="structtc__hmac__state__struct.html">tc_hmac_state_struct</a> buffer to init </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af372d6392e15439a96bc528282c5f819"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af372d6392e15439a96bc528282c5f819">&#9670;&nbsp;</a></span>tc_hmac_set_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tc_hmac_set_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tc__hmac_8h.html#a73d9f54416f1838f8a52e84e57d0393c">TCHmacState_t</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>key_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>HMAC set key procedure Configures ctx to use key. </p>
<dl class="section return"><dt>Returns</dt><dd>returns TC_CRYPTO_SUCCESS (1) returns TC_CRYPTO_FAIL (0) if ctx == NULL or key == NULL or key_size == 0 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>IN/OUT &ndash; the struct <a class="el" href="structtc__hmac__state__struct.html">tc_hmac_state_struct</a> to initial </td></tr>
    <tr><td class="paramname">key</td><td>IN &ndash; the HMAC key to configure </td></tr>
    <tr><td class="paramname">key_size</td><td>IN &ndash; the HMAC key size </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a83321bef5a518417fb895bab06322e05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83321bef5a518417fb895bab06322e05">&#9670;&nbsp;</a></span>tc_hmac_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tc_hmac_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tc__hmac_8h.html#a73d9f54416f1838f8a52e84e57d0393c">TCHmacState_t</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>HMAC update procedure Mixes data_length bytes addressed by data into state. </p>
<dl class="section return"><dt>Returns</dt><dd>returns TC_CRYPTO_SUCCCESS (1) returns TC_CRYPTO_FAIL (0) if: ctx == NULL or key == NULL </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Assumes state has been initialized by tc_hmac_init </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>IN/OUT &ndash; state of HMAC computation so far </td></tr>
    <tr><td class="paramname">data</td><td>IN &ndash; data to incorporate into state </td></tr>
    <tr><td class="paramname">data_length</td><td>IN &ndash; size of data in bytes </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ndn-lite: ndn-lite/security/detail/default-backend/sec-lib/tinycrypt/tc_cbc_mode.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ndn-lite
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_7b0e37da7babb979670076952144507a.html">ndn-lite</a></li><li class="navelem"><a class="el" href="dir_e11f8668a8afaa48b9db85612cf98717.html">security</a></li><li class="navelem"><a class="el" href="dir_4ffa99c4c6c62fc7e750c61d6d7ea688.html">detail</a></li><li class="navelem"><a class="el" href="dir_49fd263b56478561f7cdd77b538569d5.html">default-backend</a></li><li class="navelem"><a class="el" href="dir_27af200cdbae7975d997499e67e9e2cc.html">sec-lib</a></li><li class="navelem"><a class="el" href="dir_d2e430651bddbae665f4977d269e437d.html">tinycrypt</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tc_cbc_mode.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Interface to a CBC mode implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="tc__aes_8h_source.html">tc_aes.h</a>&quot;</code><br />
</div>
<p><a href="tc__cbc__mode_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6fb44be5deea10207517ae2946f28475"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tc__cbc__mode_8h.html#a6fb44be5deea10207517ae2946f28475">tc_cbc_mode_encrypt</a> (uint8_t *out, unsigned int outlen, const uint8_t *in, unsigned int inlen, const uint8_t *iv, const <a class="el" href="tc__aes_8h.html#a32bcef43049810395433f8040b3dc40e">TCAesKeySched_t</a> sched)</td></tr>
<tr class="memdesc:a6fb44be5deea10207517ae2946f28475"><td class="mdescLeft">&#160;</td><td class="mdescRight">CBC encryption procedure CBC encrypts inlen bytes of the in buffer into the out buffer using the encryption key schedule provided, prepends iv to out.  <a href="#a6fb44be5deea10207517ae2946f28475">More...</a><br /></td></tr>
<tr class="separator:a6fb44be5deea10207517ae2946f28475"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ab730b5a630475bd83ac945f942e750"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tc__cbc__mode_8h.html#a2ab730b5a630475bd83ac945f942e750">tc_cbc_mode_decrypt</a> (uint8_t *out, unsigned int outlen, const uint8_t *in, unsigned int inlen, const uint8_t *iv, const <a class="el" href="tc__aes_8h.html#a32bcef43049810395433f8040b3dc40e">TCAesKeySched_t</a> sched)</td></tr>
<tr class="memdesc:a2ab730b5a630475bd83ac945f942e750"><td class="mdescLeft">&#160;</td><td class="mdescRight">CBC decryption procedure CBC decrypts inlen bytes of the in buffer into the out buffer using the provided encryption key schedule.  <a href="#a2ab730b5a630475bd83ac945f942e750">More...</a><br /></td></tr>
<tr class="separator:a2ab730b5a630475bd83ac945f942e750"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Interface to a CBC mode implementation. </p>
<p>Overview: CBC (for "cipher block chaining") mode is a NIST approved mode of operation defined in SP 800-38a. It can be used with any block cipher to provide confidentiality of strings whose lengths are multiples of the block_size of the underlying block cipher. TinyCrypt hard codes AES as the block cipher.</p>
<p>Security: CBC mode provides data confidentiality given that the maximum number q of blocks encrypted under a single key satisfies q &lt; 2^63, which is not a practical constraint (it is considered a good practice to replace the encryption when q == 2^56). CBC mode provides NO data integrity.</p>
<p>CBC mode assumes that the IV value input into the tc_cbc_mode_encrypt is randomly generated. The TinyCrypt library provides HMAC-PRNG module, which generates suitable IVs. Other methods for generating IVs are acceptable, provided that the values of the IVs generated appear random to any adversary, including someone with complete knowledge of the system design.</p>
<p>The randomness property on which CBC mode's security depends is the unpredictability of the IV. Since it is unpredictable, this means in practice that CBC mode requires that the IV is stored somehow with the ciphertext in order to recover the plaintext.</p>
<p>TinyCrypt CBC encryption prepends the IV to the ciphertext, because this affords a more efficient (few buffers) decryption. Hence tc_cbc_mode_encrypt assumes the ciphertext buffer is always 16 bytes larger than the plaintext buffer.</p>
<p>Requires: AES-128</p>
<p>Usage: 1) call tc_cbc_mode_encrypt to encrypt data. </p><pre class="fragment">      2) call tc_cbc_mode_decrypt to decrypt data.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a2ab730b5a630475bd83ac945f942e750"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ab730b5a630475bd83ac945f942e750">&#9670;&nbsp;</a></span>tc_cbc_mode_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tc_cbc_mode_decrypt </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>outlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="tc__aes_8h.html#a32bcef43049810395433f8040b3dc40e">TCAesKeySched_t</a>&#160;</td>
          <td class="paramname"><em>sched</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CBC decryption procedure CBC decrypts inlen bytes of the in buffer into the out buffer using the provided encryption key schedule. </p>
<dl class="section return"><dt>Returns</dt><dd>returns TC_CRYPTO_SUCCESS (1) returns TC_CRYPTO_FAIL (0) if: out == NULL or in == NULL or sched == NULL or inlen == 0 or outlen == 0 or (inlen % TC_AES_BLOCK_SIZE) != 0 or (outlen % TC_AES_BLOCK_SIZE) != 0 or outlen != inlen + TC_AES_BLOCK_SIZE </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Assumes:- in == iv + ciphertext, i.e. the iv and the ciphertext are contiguous. This allows for a very efficient decryption algorithm that would not otherwise be possible<ul>
<li>sched was configured by aes_set_decrypt_key</li>
<li>out buffer is large enough to hold the decrypted plaintext and is a contiguous buffer</li>
<li>inlen gives the number of bytes in the in buffer </li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">out</td><td>IN/OUT &ndash; buffer to receive decrypted data </td></tr>
    <tr><td class="paramname">outlen</td><td>IN &ndash; length of plaintext buffer in bytes </td></tr>
    <tr><td class="paramname">in</td><td>IN &ndash; ciphertext to decrypt, including IV </td></tr>
    <tr><td class="paramname">inlen</td><td>IN &ndash; length of ciphertext buffer in bytes </td></tr>
    <tr><td class="paramname">iv</td><td>IN &ndash; the IV for the this encrypt/decrypt </td></tr>
    <tr><td class="paramname">sched</td><td>IN &ndash; AES key schedule for this decrypt </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6fb44be5deea10207517ae2946f28475"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fb44be5deea10207517ae2946f28475">&#9670;&nbsp;</a></span>tc_cbc_mode_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tc_cbc_mode_encrypt </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>outlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="tc__aes_8h.html#a32bcef43049810395433f8040b3dc40e">TCAesKeySched_t</a>&#160;</td>
          <td class="paramname"><em>sched</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CBC encryption procedure CBC encrypts inlen bytes of the in buffer into the out buffer using the encryption key schedule provided, prepends iv to out. </p>
<dl class="section return"><dt>Returns</dt><dd>returns TC_CRYPTO_SUCCESS (1) returns TC_CRYPTO_FAIL (0) if: out == NULL or in == NULL or ctr == NULL or sched == NULL or inlen == 0 or (inlen % TC_AES_BLOCK_SIZE) != 0 or (outlen % TC_AES_BLOCK_SIZE) != 0 or outlen != inlen + TC_AES_BLOCK_SIZE </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Assumes: - sched has been configured by aes_set_encrypt_key<ul>
<li>iv contains a 16 byte random string</li>
<li>out buffer is large enough to hold the ciphertext + iv</li>
<li>out buffer is a contiguous buffer</li>
<li>in holds the plaintext and is a contiguous buffer</li>
<li>inlen gives the number of bytes in the in buffer </li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">out</td><td>IN/OUT &ndash; buffer to receive the ciphertext </td></tr>
    <tr><td class="paramname">outlen</td><td>IN &ndash; length of ciphertext buffer in bytes </td></tr>
    <tr><td class="paramname">in</td><td>IN &ndash; plaintext to encrypt </td></tr>
    <tr><td class="paramname">inlen</td><td>IN &ndash; length of plaintext buffer in bytes </td></tr>
    <tr><td class="paramname">iv</td><td>IN &ndash; the IV for the this encrypt/decrypt </td></tr>
    <tr><td class="paramname">sched</td><td>IN &ndash; AES key schedule for this encrypt </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
